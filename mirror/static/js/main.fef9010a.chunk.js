(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{118:function(e,t,a){e.exports=a(300)},123:function(e,t,a){},125:function(e,t,a){},300:function(e,t,a){"use strict";a.r(t);var n=a(0),r=a.n(n),s=a(22),o=a.n(s),i=(a(123),a(14)),l=a(15),c=a(18),u=a(16),p=a(17),m=(a(125),a(116)),d=a(20),h=a.n(d),v=a(29),g=a(33),f=a(41),b=a.n(f),y={GET_MODULE:"/api/model",GET_VISUALISATIONS:"/api/visualisation",PUT_VISUALISATIONS:"/api/visualisation",getModuleLayerOutput:function(e){return"/api/model/layer/output/".concat(e)}},E=(a(150),function(e){function t(){var e,a;Object(i.a)(this,t);for(var n=arguments.length,r=new Array(n),s=0;s<n;s++)r[s]=arguments[s];return(a=Object(c.a)(this,(e=Object(u.a)(t)).call.apply(e,[this].concat(r)))).state={tree:null,visualisations:[],currentVisualisation:{},isLoading:!1,open:!1,outputs:[],layer:{name:""},last:0,next:!1,settings:{size:50}},a.toogleDrawer=Object(v.a)(h.a.mark(function e(){return h.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,a.setState({open:!a.state.open});case 2:case"end":return e.stop()}},e,this)})),a.getLayerOutputs=Object(v.a)(h.a.mark(function e(){var t,n,r,s,o,i,l=arguments;return h.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return t=l.length>0&&void 0!==l[0]?l[0]:a.state.layer,n=l.length>1&&void 0!==l[1]&&l[1],r=t.id==a.state.layer.id,n&&(r=!1),s=r?a.state.last+64:0,e.prev=5,e.next=8,a.setState({isLoading:!0});case 8:return e.next=10,b.a.get(y.getModuleLayerOutput(t.id,s),{params:{last:s}});case 10:return o=e.sent,i=r?a.state.outputs.concat(o.data.links):o.data.links,e.next=14,a.setState({outputs:i,layer:t,last:s,isLoading:!1,next:o.data.next});case 14:e.next=20;break;case 16:return e.prev=16,e.t0=e.catch(5),e.next=20,a.setState({isLoading:!1});case 20:case"end":return e.stop()}},e,this,[[5,16]])})),a.changeSettings=function(){var e=Object(v.a)(h.a.mark(function e(t){return h.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,a.setState({settings:t});case 2:case"end":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}(),a}return Object(p.a)(t,e),Object(l.a)(t,[{key:"getTree",value:function(){var e=Object(v.a)(h.a.mark(function e(){var t,a;return h.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.setState({isLoading:!0});case 2:return e.next=4,b.a.get(y.GET_MODULE);case 4:return t=e.sent,a=t.data,e.next=8,this.setState({tree:a,isLoading:!1});case 8:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}()},{key:"getVisualisations",value:function(){var e=Object(v.a)(h.a.mark(function e(){var t,a,n;return h.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.setState({isLoading:!0});case 2:return e.next=4,b.a.get(y.GET_VISUALISATIONS);case 4:return t=e.sent,a=t.data.visualisations,n=t.data.current,e.next=9,this.setState({visualisations:a,isLoading:!1,currentVisualisation:n});case 9:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}()},{key:"setVisualisationsSettings",value:function(){var e=Object(v.a)(h.a.mark(function e(t){var a,n,r,s;return h.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.setState({isLoading:!0});case 2:return e.next=4,b.a.put(y.PUT_VISUALISATIONS,t);case 4:for(s in a=e.sent,n=a.data,r=Object(m.a)(this.state.visualisations))r[s].name==n.name&&(r[s]=n);return e.next=10,this.setState({isLoading:!1,currentVisualisation:n,visualisations:r});case 10:case"end":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}()}]),t}(g.a)),O=a(23),j=a.n(O),w=a(24),x=a.n(w),k=a(27),S=a.n(k),L=a(109),C=a.n(L),I=a(107),N=a.n(I),A=a(108),V=a.n(A),M=function(e){function t(){var e,a;Object(i.a)(this,t);for(var n=arguments.length,s=new Array(n),o=0;o<n;o++)s[o]=arguments[o];return(a=Object(c.a)(this,(e=Object(u.a)(t)).call.apply(e,[this].concat(s)))).state={open:!1},a.getMoreOnScrollBottom=function(){var e=a.props.module.state.layerId==a.props.layer.id;window.scrollY==window.scrollMaxY&&e&&!a.props.module.state.isLoading&&a.props.module.getLayerOutputs(a.props.layer.id)},a.handleClick=function(e){a.setState(function(e){return{open:!e.open}}),a.props.module.getLayerOutputs(e)},a.renderLayer=function(e){var n=a.props.layer.name.split("(")[0];return r.a.createElement(j.a,null,r.a.createElement(x.a,{button:!0,onClick:function(){return a.handleClick(a.props.layer)}},r.a.createElement(S.a,{primary:n}),a.state.open?r.a.createElement(N.a,null):r.a.createElement(V.a,null)),r.a.createElement(C.a,{in:a.state.open,timeout:"auto",unmountOnExit:!0},e.children.map(function(e,n){return r.a.createElement(t,{layer:e,module:a.props.module,key:n,deepth:a.props.deepth+1})})))},a}return Object(p.a)(t,e),Object(l.a)(t,[{key:"componentDidMount",value:function(){window.addEventListener("scroll",this.getMoreOnScrollBottom)}},{key:"componentWillUnmount",value:function(){window.addEventListener("scroll",this.getMoreOnScrollBottom)}},{key:"render",value:function(){var e=this.props.layer;return r.a.createElement(j.a,{style:{marginLeft:8*this.props.deepth/2}},e?this.renderLayer(e):r.a.createElement(x.a,null))}}]),t}(n.Component),T=function(e){function t(){return Object(i.a)(this,t),Object(c.a)(this,Object(u.a)(t).apply(this,arguments))}return Object(p.a)(t,e),Object(l.a)(t,[{key:"componentDidMount",value:function(){this.props.module.getTree()}},{key:"render",value:function(){var e=this.props.module.state.tree;return r.a.createElement(j.a,null,r.a.createElement(M,{layer:e,module:this.props.module,deepth:1}))}}]),t}(n.Component),D=a(26),U=a(55),z=a.n(U),B=a(54),P=a.n(B),G=a(71),_=a.n(G),W=a(110),J=function(e){function t(){var e,a;Object(i.a)(this,t);for(var n=arguments.length,s=new Array(n),o=0;o<n;o++)s[o]=arguments[o];return(a=Object(c.a)(this,(e=Object(u.a)(t)).call.apply(e,[this].concat(s)))).update=function(e){var t=Object(D.a)({},a.props.param,e),n={};n[a.props.name]=t,a.props.update(n)},a.makeParam=function(e){if("slider"==e.type){var t=e.max,n=e.min,s=e.step,o=e.value;return r.a.createElement(P.a,{value:o,"aria-labelledby":"label",min:n,max:t,step:s,onChange:Object(W.a)(300,function(t,n){return a.update(Object(D.a)({},e,{value:n}))})})}if("radio"==e.type)return r.a.createElement(_.a,{checked:e.value,onChange:function(t,n){return a.update(Object(D.a)({},e,{value:!e.value}))},value:"a",name:"radio-button-demo","aria-label":"A"})},a}return Object(p.a)(t,e),Object(l.a)(t,[{key:"render",value:function(){var e=this,a=this.props,n=a.classes,s=(a.module,a.param),o=a.name,i=s.params;return r.a.createElement(j.a,{disablePadding:!0},r.a.createElement(x.a,null,r.a.createElement(S.a,null,r.a.createElement("div",null,o),r.a.createElement("div",{className:n.sliders},this.makeParam(s)))),r.a.createElement(x.a,null,Object.keys(i).map(function(a,n){return r.a.createElement(t,Object.assign({},e.props,{name:a,param:i[a],update:e.update,key:n}))})))}}]),t}(n.Component),Y=function(e){function t(){var e,a;Object(i.a)(this,t);for(var n=arguments.length,r=new Array(n),s=0;s<n;s++)r[s]=arguments[s];return(a=Object(c.a)(this,(e=Object(u.a)(t)).call.apply(e,[this].concat(r)))).update=function(e){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];if(console.log("from down",e),t){var n=Object(D.a)({},a.props.visualisation.params,e);n=Object(D.a)({},a.props.visualisation,{params:n})}else n=Object(D.a)({},a.props.visualisation,e);console.log(n),a.props.module.setVisualisationsSettings(n),a.props.module.getLayerOutputs(a.props.module.state.layer,!0)},a}return Object(p.a)(t,e),Object(l.a)(t,[{key:"render",value:function(){var e=this,t=this.props,a=(t.module,t.visualisation),n=a.name,s=a.params;return r.a.createElement(j.a,null,r.a.createElement(x.a,null,r.a.createElement(S.a,null,r.a.createElement("div",null,n)),r.a.createElement(_.a,{checked:this.props.module.state.currentVisualisation.name==n,onChange:function(t,n){return e.update(Object(D.a)({},a,{value:n}),!1)},value:"a",name:"radio-button-demo","aria-label":"A"})),Object.keys(s).map(function(t,a){return r.a.createElement(J,Object.assign({},e.props,{name:t,param:s[t],update:e.update,key:a}))}))}}]),t}(n.Component),H=function(e){function t(){var e,a;Object(i.a)(this,t);for(var n=arguments.length,r=new Array(n),s=0;s<n;s++)r[s]=arguments[s];return(a=Object(c.a)(this,(e=Object(u.a)(t)).call.apply(e,[this].concat(r)))).onVisualisationSettingsChange=function(e){a.props.module.setVisualisationsSettings(e)},a.handleSlider=function(e,t){var n=a.props.module,r=n.state.settings;r=Object.assign({},r,{size:t}),n.changeSettings(r)},a}return Object(p.a)(t,e),Object(l.a)(t,[{key:"componentDidMount",value:function(){this.props.module.getVisualisations()}},{key:"render",value:function(){var e=this,t=this.props,a=t.toogle,n=t.classes,s=t.open,o=t.module,i=t.small,l=void 0!==i&&i;return r.a.createElement(z.a,{anchor:"right",variant:l?"temporary":"permanent",open:s,className:n.drawer,onClose:a,classes:{paper:n.drawerPaper}},r.a.createElement("div",{className:n.toolbar}),r.a.createElement(j.a,{className:n.settings},r.a.createElement(x.a,null,r.a.createElement(S.a,null,"Image size : ",o.state.settings.size)),r.a.createElement(x.a,null,r.a.createElement(P.a,{value:o.state.settings.size,"aria-labelledby":"label",min:1,max:100,step:1,onChange:this.handleSlider}))),r.a.createElement(j.a,{className:n.settings},r.a.createElement(x.a,null,r.a.createElement(S.a,null,r.a.createElement("div",null,"Visualisations"),this.props.module.state.visualisations.map(function(t,a){return r.a.createElement(Y,Object.assign({key:a},e.props,{visualisation:t,update:e.onVisualisationSettingsChange}))})))))}}]),t}(n.Component),$=a(112),q=a.n($),F=a(70),K=a.n(F),Q=a(39),R=a.n(Q),X=a(113),Z=a.n(X),ee=a(53),te=a(115),ae=a.n(te),ne=a(40),re=a(28),se=a.n(re),oe=a(111),ie=a.n(oe),le=(n.Component,function(e){var t=e.src,a=e.size,n={height:"".concat(a/10*100,"px"),width:"".concat(a/10*100,"px")};return r.a.createElement(se.a,{item:!0},r.a.createElement("img",{src:t,style:n}))}),ce=function(e){function t(){return Object(i.a)(this,t),Object(c.a)(this,Object(u.a)(t).apply(this,arguments))}return Object(p.a)(t,e),Object(l.a)(t,[{key:"render",value:function(){var e=this.props,t=e.module;e.classes;return r.a.createElement("div",null,r.a.createElement(se.a,{container:!0,direction:"row",justify:"center",alignItems:"center",spacing:8},r.a.createElement(se.a,{item:!0,xs:12},r.a.createElement(R.a,{variant:"h6",gutterBottom:!0,style:{textAlign:"center"}},t.state.layer.name.split("(")[0])),t.state.outputs.map(function(e,a){return r.a.createElement(le,Object.assign({src:e},t.state.settings,{key:a}))})),r.a.createElement(se.a,{container:!0,direction:"row",justify:"center",alignItems:"center",spacing:8},r.a.createElement(se.a,{item:!0},0==this.props.module.state.outputs.length?r.a.createElement("h1",null,"Nothing to show"):this.props.module.state.next?r.a.createElement(ie.a,{variant:"contained",color:"primary",onClick:function(){return t.getLayerOutputs()}},"More"):"")))}}]),t}(r.a.Component),ue=a(114),pe=a.n(ue),me=a(56),de=a.n(me);function he(e){var t=e.module,a=e.classes;return r.a.createElement(q.a,{position:"fixed",className:a.appBar},r.a.createElement(Z.a,null,r.a.createElement(R.a,{variant:"h6",color:"inherit",noWrap:!0},"Mirror"),r.a.createElement("div",{style:{flexGrow:1}}),r.a.createElement(de.a,{mdUp:!0},r.a.createElement(K.a,{color:"inherit",onClick:t.toogleDrawer},r.a.createElement(pe.a,null)))))}var ve=function(e){function t(){var e,a;Object(i.a)(this,t);for(var n=arguments.length,r=new Array(n),s=0;s<n;s++)r[s]=arguments[s];return(a=Object(c.a)(this,(e=Object(u.a)(t)).call.apply(e,[this].concat(r)))).state={openSettings:!1},a.toggleSettings=function(){var e=!a.state.openSettings;a.setState({openSettings:e})},a}return Object(p.a)(t,e),Object(l.a)(t,[{key:"render",value:function(){var e=this,t=this.props.classes;return r.a.createElement(g.b,null,r.a.createElement(g.c,{to:[E]},function(a){return r.a.createElement("div",{className:t.root},r.a.createElement(he,Object.assign({module:he},e.props,{module:a})),r.a.createElement(z.a,{variant:"permanent",className:t.drawer,classes:{paper:t.drawerPaper}},r.a.createElement("div",{className:t.toolbar}),r.a.createElement(T,{module:a})),a.state.isLoading?r.a.createElement(ae.a,{color:"secondary",className:t.progress}):"",r.a.createElement("main",{className:t.content},r.a.createElement("div",{className:t.toolbar}),r.a.createElement(ce,{module:a,classes:t})),r.a.createElement(de.a,{smDown:!0},r.a.createElement(H,{toogle:a.toogleDrawer,open:a.state.open,module:a,classes:t})),r.a.createElement(de.a,{mdUp:!0},r.a.createElement(H,{toogle:a.toogleDrawer,open:a.state.open,module:a,classes:t,small:!0})))}))}}]),t}(n.Component),ge=Object(ee.withStyles)(function(e){return{root:{flexGrow:1,display:"flex",flexDirection:"row",minHeight:"100vh"},typography:{useNextVariants:!0},appBar:{zIndex:e.zIndex.drawer+1},drawer:{width:300,flexShrink:0},drawerPaper:{flexShrink:0,width:300},content:{flexGrow:1,backgroundColor:e.palette.background.default,padding:3*e.spacing.unit},toolbar:e.mixins.toolbar,progress:{position:"fixed",top:"0",width:"100vw",zIndex:9999},settings:{width:"300px !important"},sliders:{width:"200px !important"},layersOuput:{}}})(ve);Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));o.a.render(r.a.createElement(ge,null),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then(function(e){e.unregister()})}},[[118,2,1]]]);
//# sourceMappingURL=main.fef9010a.chunk.js.map